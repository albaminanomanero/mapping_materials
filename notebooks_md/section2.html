<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.554">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Mapping Economic Landscapes - 2&nbsp; Course foundations: data management</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../notebooks_md/section3.html" rel="next">
<link href="../s1_intro_python.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../style_breadcrumb.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../s1_intro_python.html">Introduction to Python</a></li><li class="breadcrumb-item"><a href="../notebooks_md/section2.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Course foundations: data management</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Mapping Economic Landscapes</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About this course</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../installation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Installation guidelines</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Introduction to Python</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../s1_intro_python.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Course foundations: Jupyter Notebooks, Python syntax, and NumPy</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_md/section2.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Course foundations: data management</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Visualization of geographic data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_md/section3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Introducing geographic data</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Processing and analysis of geographic data</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="2">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#data-management-with-pandas" id="toc-data-management-with-pandas" class="nav-link active" data-scroll-target="#data-management-with-pandas"><span class="header-section-number">2.1</span> Data management with Pandas</a>
  <ul class="collapse">
  <li><a href="#data-structures" id="toc-data-structures" class="nav-link" data-scroll-target="#data-structures"><span class="header-section-number">2.1.1</span> Data structures</a></li>
  <li><a href="#creating-a-dataframe." id="toc-creating-a-dataframe." class="nav-link" data-scroll-target="#creating-a-dataframe."><span class="header-section-number">2.1.2</span> Creating a DataFrame.</a></li>
  <li><a href="#importing-and-exporting-data" id="toc-importing-and-exporting-data" class="nav-link" data-scroll-target="#importing-and-exporting-data"><span class="header-section-number">2.1.3</span> Importing and exporting data</a></li>
  <li><a href="#filtering-and-subsetting-dataframes." id="toc-filtering-and-subsetting-dataframes." class="nav-link" data-scroll-target="#filtering-and-subsetting-dataframes."><span class="header-section-number">2.1.4</span> Filtering and subsetting dataframes.</a></li>
  <li><a href="#creating-new-columns" id="toc-creating-new-columns" class="nav-link" data-scroll-target="#creating-new-columns"><span class="header-section-number">2.1.5</span> Creating new columns</a></li>
  <li><a href="#merging-tables." id="toc-merging-tables." class="nav-link" data-scroll-target="#merging-tables."><span class="header-section-number">2.1.6</span> Merging tables.</a></li>
  <li><a href="#summary-statistics-and-groupby-operations." id="toc-summary-statistics-and-groupby-operations." class="nav-link" data-scroll-target="#summary-statistics-and-groupby-operations."><span class="header-section-number">2.1.7</span> Summary statistics and groupby operations.</a></li>
  </ul></li>
  <li><a href="#visualization-matplotlib-and-seaborn." id="toc-visualization-matplotlib-and-seaborn." class="nav-link" data-scroll-target="#visualization-matplotlib-and-seaborn."><span class="header-section-number">2.2</span> Visualization: Matplotlib and Seaborn.</a></li>
  <li><a href="#practice-exercises" id="toc-practice-exercises" class="nav-link" data-scroll-target="#practice-exercises"><span class="header-section-number">2.3</span> Practice exercises</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../s1_intro_python.html">Introduction to Python</a></li><li class="breadcrumb-item"><a href="../notebooks_md/section2.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Course foundations: data management</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Course foundations: data management</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Now that we are familiar with the basics of Python syntax and how to interact with it, it’s time to learn how to manage and visualize data. In this section, we’ll explore widely-used libraries such as <code>Pandas</code>, which enable us to handle and analyze data effectively. We’ll get to know one of the fundamental data structures in <code>Pandas</code>, the <code>DataFrame</code>. Finally, we’ll learn some visualization techniques using <code>Seaborn</code>. Again, if you are already familiar with this concepts, feel free to move to the next section.</p>
<section id="data-management-with-pandas" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="data-management-with-pandas"><span class="header-section-number">2.1</span> Data management with Pandas</h2>
<p><code>Pandas</code> is a Python library designed for efficient and practical data analysis tasks (clean, manipulate, analyze). Differently from <code>NumPy</code>, which is designed to work with numerical arrays, Pandas is designed to handle relational or labeled data (i.e., data that has been given a context or meaning through labels).</p>
<p><code>Pandas</code> and <code>NumPy</code> share some similarities as Pandas builds on <code>NumPy</code>. However, rather than arrays, the main object for 2D data management in Pandas is the <code>DataFrame</code> (equivalent to data.frame in R). <code>DataFrames</code> are essentially matrices with labeled columns and rows that can accommodate mixed datatypes and missing values. <code>DataFrames</code> are composed of rows and columns. Row labels are known as <code>indices</code> (start from 0) and column labels as <code>columns names</code>.</p>
<p>Pandas is a very good tool for:</p>
<ul>
<li>Dealing with missing data</li>
<li>Adding or deleting columns</li>
<li>Align data on labels or not on labels (i.e., merging and joining)</li>
<li>Perform grouped operations on data sets.</li>
<li>Transforming other Python data structures to DataFrames.</li>
<li>Multi-indexing hierarchically.</li>
<li>Load data from multiple file types.</li>
<li>Handling time-series data, as it has specific time-series functionalities.</li>
</ul>
<section id="data-structures" class="level3" data-number="2.1.1">
<h3 data-number="2.1.1" class="anchored" data-anchor-id="data-structures"><span class="header-section-number">2.1.1</span> Data structures</h3>
<p><code>Pandas</code> builds on two main data structures: <code>Series</code> and <code>DataFrames</code>. A <code>Series</code> represents a 1D array, while a <code>DataFrame</code> is a 2D labeled array. The easiest way to understand these structures is to think of <code>DataFrames</code> as containers for lower-dimensional data. Specifically, the columns of a <code>DataFrame</code> are composed of <code>Series</code>, and each element within a <code>Series</code> (i.e., the rows of the <code>DataFrame</code>) is an individual scalar value, such as a number or a string. In simple terms, <code>Series</code> are columns made of scalar elements, and <code>DataFrames</code> are collections of <code>Series</code> with assigned labels. The image below represents a <code>DataFrame</code>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../img/img1_pandasdf.png" class="img-fluid figure-img"></p>
<figcaption>Source: Pandas documentation</figcaption>
</figure>
</div>
<p>All <code>Pandas</code> data structures are value-mutable (i.e., we can change the values of elements and replace <code>DataFrames</code>) but some are not always size-mutable. The length of a <code>Series</code> cannot be changed, but, for example, columns can be inserted into a <code>DataFrame</code>.</p>
</section>
<section id="creating-a-dataframe." class="level3" data-number="2.1.2">
<h3 data-number="2.1.2" class="anchored" data-anchor-id="creating-a-dataframe."><span class="header-section-number">2.1.2</span> Creating a DataFrame.</h3>
<p>There are two primary methods to create <code>DataFrames</code> and <code>Series</code> in <code>Pandas</code>. Firstly, they can be constructed by transforming built-in Python data structures like lists or dictionaries. Secondly, they can be generated by importing data, for example, by reading .csv files. Let’s begin by examining how to create them from Python structures.</p>
<p>For any code we want to run that uses <code>pandas</code>, just as we did with <code>NumPy</code>, we have to first import it. In the second line of code of the cell below, I am modifying the display options so that we can see all columns in a dataframe; otherwise, there is a default limit, and some columns get collapsed in previews.</p>
<div id="5fe8316f" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>pandas.set_option(<span class="st">'display.max_columns'</span>, <span class="va">None</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The first example illustrates how to create a <code>DataFrame</code> from a dictionary.</p>
<div id="d31c9809" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>phds <span class="op">=</span> {<span class="st">'Name'</span>: [<span class="st">'Joël Marbet'</span>, <span class="st">'Alba Miñano-Mañero'</span>,<span class="st">'Dmitri Kirpichev'</span>,</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>                <span class="st">'Yang Xun'</span>,<span class="st">'Utso Pal Mustafi'</span>,</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>                <span class="st">'Christian Maruthiah'</span>,<span class="st">'Kazuharu Yanagimoto'</span>], </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Undergrad University'</span>: [<span class="st">'Univeristy of Bern'</span>, <span class="st">'University of València'</span>,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'Universidad Complutense de Madrid'</span>,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'Renmin University of China'</span>,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'Presidency University'</span>,<span class="st">'University of Melbourne'</span>,<span class="st">'University of Tokyo'</span>],</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Fields'</span>:[<span class="st">'Monetary Economics'</span>,<span class="st">'Urban Economics'</span>,<span class="st">'Applied Economics'</span>,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>                <span class="st">'Development Economics'</span>,<span class="st">'Macro-Finance'</span>,</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>                <span class="st">'Development Economics'</span>,<span class="st">'Macroeconomics'</span>],</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">'PhD Desk'</span>: [<span class="dv">20</span>,<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">15</span>,<span class="dv">18</span>,<span class="dv">23</span>,<span class="dv">5</span>]}</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>phd_df <span class="op">=</span> pandas.DataFrame(phds)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>phd_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Undergrad University</th>
<th data-quarto-table-cell-role="th">Fields</th>
<th data-quarto-table-cell-role="th">PhD Desk</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Joël Marbet</td>
<td>Univeristy of Bern</td>
<td>Monetary Economics</td>
<td>20</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Alba Miñano-Mañero</td>
<td>University of València</td>
<td>Urban Economics</td>
<td>10</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Dmitri Kirpichev</td>
<td>Universidad Complutense de Madrid</td>
<td>Applied Economics</td>
<td>11</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Yang Xun</td>
<td>Renmin University of China</td>
<td>Development Economics</td>
<td>15</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Utso Pal Mustafi</td>
<td>Presidency University</td>
<td>Macro-Finance</td>
<td>18</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>Christian Maruthiah</td>
<td>University of Melbourne</td>
<td>Development Economics</td>
<td>23</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>Kazuharu Yanagimoto</td>
<td>University of Tokyo</td>
<td>Macroeconomics</td>
<td>5</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>To find out how many rows and columns a dataframe has, we can call the <code>.shape</code> attribute. For instance, the dataframe we just created has 2 rows and 4 columns.</p>
<div id="3a9685d3" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>phd_df.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>(7, 4)</code></pre>
</div>
</div>
<p>We can work with single columns or subset our dataframe to a set of columns by calling the columns names in square braces <code>[]</code>. The returning column will be of the <code>pandas.Series</code> type.</p>
<div id="6ed584d5" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>phd_df[<span class="st">'Name'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>0            Joël Marbet
1     Alba Miñano-Mañero
2       Dmitri Kirpichev
3               Yang Xun
4       Utso Pal Mustafi
5    Christian Maruthiah
6    Kazuharu Yanagimoto
Name: Name, dtype: object</code></pre>
</div>
</div>
<div id="ed8949a4" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(phd_df[<span class="st">'Name'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>pandas.core.series.Series</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
My tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Using double braces (<code>[[]]</code>) to subset a <code>DataFrame</code> results in a <code>DataFrame</code> rather than a <code>Series</code>. This is so because the inner pair of brackets creates a list of columns, while the outer pair allows for data selection from the <code>DataFrame</code>.</p>
</div>
</div>
<div id="ae3636d5" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>phd_df[[<span class="st">'Name'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Joël Marbet</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Alba Miñano-Mañero</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Dmitri Kirpichev</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Yang Xun</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Utso Pal Mustafi</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>Christian Maruthiah</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>Kazuharu Yanagimoto</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<div id="e6025bf5" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(phd_df[[<span class="st">'Name'</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>pandas.core.frame.DataFrame</code></pre>
</div>
</div>
<p>Columns names can be accessed by calling the attribute <code>.columns</code> of a dataframe.</p>
<div id="16d00dd3" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>phd_df.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>Index(['Name', 'Undergrad University', 'Fields', 'PhD Desk'], dtype='object')</code></pre>
</div>
</div>
<p>With this in mind, we can copy a selection of our <code>DataFrame</code> to a new one. We use the <code>.copy()</code> method to generate a copy of the data and avoid broadcasting any change to the original frame we are subsetting.</p>
<div id="72aa1e58" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>phd_df2 <span class="op">=</span> phd_df[[<span class="st">'Name'</span>,<span class="st">'Fields'</span>]].copy()</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>phd_df2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Fields</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Joël Marbet</td>
<td>Monetary Economics</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Alba Miñano-Mañero</td>
<td>Urban Economics</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Dmitri Kirpichev</td>
<td>Applied Economics</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Yang Xun</td>
<td>Development Economics</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Utso Pal Mustafi</td>
<td>Macro-Finance</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>Christian Maruthiah</td>
<td>Development Economics</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>Kazuharu Yanagimoto</td>
<td>Macroeconomics</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>We could also create a dataframe from other Python data-structures. In the example below, the same <code>DataFrame</code> is created from a list. If we do not specify the column names, it will just give numeric labels to columns from 0 to <span class="math inline">\(n\)</span>.</p>
<div id="0604f386" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>phds_list <span class="op">=</span> [</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    [<span class="st">'Joël Marbet'</span>, <span class="st">'University of Bern'</span>, <span class="st">'Monetary Economics'</span>, <span class="dv">20</span>],</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    [<span class="st">'Alba Miñano-Mañero'</span>, <span class="st">'University of València'</span>, <span class="st">'Urban Economics'</span>, <span class="dv">10</span>],</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    [<span class="st">'Dmitri Kirpichev'</span>, <span class="st">'Universidad Complutense de Madrid'</span>, </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Applied Economics'</span>, <span class="dv">11</span>],</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    [<span class="st">'Yang Xun'</span>, <span class="st">'Renmin University of China'</span>, <span class="st">'Development Economics'</span>, <span class="dv">15</span>],</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    [<span class="st">'Utso Pal Mustafi'</span>, <span class="st">'Presidency University'</span>, <span class="st">'Macro-Finance'</span>, <span class="dv">18</span>],</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    [<span class="st">'Christian Maruthiah'</span>, <span class="st">'University of Melbourne'</span>, </span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Development Economics'</span>, <span class="dv">23</span>],</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    [<span class="st">'Kazuharu Yanagimoto'</span>, <span class="st">'University of Tokyo'</span>, <span class="st">'Macroeconomics'</span>, <span class="dv">5</span>]</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a list of column names</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>column_names_list <span class="op">=</span> [<span class="st">'Name'</span>, <span class="st">'Undergraduate University'</span>, <span class="st">'Fields'</span>,<span class="st">'PhD desk'</span>]</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a DataFrame from the array, using the list as column names and the tuple as row labels</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pandas.DataFrame(phds_list, columns<span class="op">=</span>column_names_list)</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Undergraduate University</th>
<th data-quarto-table-cell-role="th">Fields</th>
<th data-quarto-table-cell-role="th">PhD desk</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Joël Marbet</td>
<td>University of Bern</td>
<td>Monetary Economics</td>
<td>20</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Alba Miñano-Mañero</td>
<td>University of València</td>
<td>Urban Economics</td>
<td>10</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Dmitri Kirpichev</td>
<td>Universidad Complutense de Madrid</td>
<td>Applied Economics</td>
<td>11</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Yang Xun</td>
<td>Renmin University of China</td>
<td>Development Economics</td>
<td>15</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Utso Pal Mustafi</td>
<td>Presidency University</td>
<td>Macro-Finance</td>
<td>18</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>Christian Maruthiah</td>
<td>University of Melbourne</td>
<td>Development Economics</td>
<td>23</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>Kazuharu Yanagimoto</td>
<td>University of Tokyo</td>
<td>Macroeconomics</td>
<td>5</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>A <code>DataFrame</code> can also be created departing from a tuple:</p>
<div id="aea4ff70" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-overflow-wrap code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>phds_tu <span class="op">=</span> (</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Joël Marbet'</span>, <span class="st">'University of Bern'</span>, <span class="st">'Monetary Economics'</span>, <span class="dv">20</span>),</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Alba Miñano-Mañero'</span>, <span class="st">'University of València'</span>, <span class="st">'Urban Economics'</span>, <span class="dv">10</span>),</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Dmitri Kirpichev'</span>, <span class="st">'Universidad Complutense de Madrid'</span>, </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Applied Economics'</span>, <span class="dv">11</span>),</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Yang Xun'</span>, <span class="st">'Renmin University of China'</span>, <span class="st">'Development Economics'</span>, <span class="dv">15</span>),</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Utso Pal Mustafi'</span>, <span class="st">'Presidency University'</span>, <span class="st">'Macro-Finance'</span>, <span class="dv">18</span>),</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Christian Maruthiah'</span>, <span class="st">'University of Melbourne'</span>, </span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Development Economics'</span>, <span class="dv">23</span>),</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Kazuharu Yanagimoto'</span>, <span class="st">'University of Tokyo'</span>, <span class="st">'Macroeconomics'</span>, <span class="dv">5</span>)</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a list of column names</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>column_names_list <span class="op">=</span> [<span class="st">'Name'</span>, <span class="st">'Undergraduate University'</span>, <span class="st">'Fields'</span>,<span class="st">'PhD desk'</span>]</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a DataFrame from the array, using the list as column names and the tuple as row labels</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pandas.DataFrame(phds_tu, columns<span class="op">=</span>column_names_list)</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Undergraduate University</th>
<th data-quarto-table-cell-role="th">Fields</th>
<th data-quarto-table-cell-role="th">PhD desk</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Joël Marbet</td>
<td>University of Bern</td>
<td>Monetary Economics</td>
<td>20</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Alba Miñano-Mañero</td>
<td>University of València</td>
<td>Urban Economics</td>
<td>10</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Dmitri Kirpichev</td>
<td>Universidad Complutense de Madrid</td>
<td>Applied Economics</td>
<td>11</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Yang Xun</td>
<td>Renmin University of China</td>
<td>Development Economics</td>
<td>15</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Utso Pal Mustafi</td>
<td>Presidency University</td>
<td>Macro-Finance</td>
<td>18</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>Christian Maruthiah</td>
<td>University of Melbourne</td>
<td>Development Economics</td>
<td>23</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>Kazuharu Yanagimoto</td>
<td>University of Tokyo</td>
<td>Macroeconomics</td>
<td>5</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<div id="656f4293" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(phds_tu)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>tuple</code></pre>
</div>
</div>
<p><code>DataFrames</code> can also receive as data source <code>NumPy</code> arrays:</p>
<div id="9422eb19" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>data_arr <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>], [<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>]])</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a DataFrame from the NumPy array</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>df_arr <span class="op">=</span> pandas.DataFrame(data_arr, columns<span class="op">=</span>[<span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'C'</span>])</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>df_arr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">A</th>
<th data-quarto-table-cell-role="th">B</th>
<th data-quarto-table-cell-role="th">C</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>2</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>4</td>
<td>5</td>
<td>6</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>7</td>
<td>8</td>
<td>9</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>Similarly, we can also transform built-in structures into <code>pandas.Series</code></p>
<div id="35b814a7" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>week_series<span class="op">=</span> pandas.Series([<span class="st">'Monday'</span>,<span class="st">'Tuesday'</span>,<span class="st">'Wednesday'</span>]) <span class="co"># from a list</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>week_series</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>0       Monday
1      Tuesday
2    Wednesday
dtype: object</code></pre>
</div>
</div>
<p>The previous line would be equivalent to first creating a list and then passing it as an argument to <code>pandas.Series</code>. We can also specify the row index, which can be very useful for join and concatenate operations. Additionally, we can specify a name</p>
<div id="713c99b0" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>week_list <span class="op">=</span> [<span class="st">'Monday'</span>,<span class="st">'Tuesday'</span>,<span class="st">'Wednesday'</span>]</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>week_l_to_series <span class="op">=</span> pandas.Series(week_list,index<span class="op">=</span><span class="bu">range</span>(<span class="dv">3</span>,<span class="dv">6</span>),name<span class="op">=</span><span class="st">'Week'</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>week_l_to_series</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>3       Monday
4      Tuesday
5    Wednesday
Name: Week, dtype: object</code></pre>
</div>
</div>
<p>We could convert that series to a <code>pandas.DataFrame()</code> that would have a column name ‘Week’ and as row index (3,4,5)</p>
<div id="ea88df1c" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>pandas.DataFrame(week_l_to_series)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Week</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>Monday</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>Tuesday</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>Wednesday</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>Similarly, <code>Series</code> can also be created from dictionaries as shown below:</p>
<div id="aeffef29" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>weekdays_s <span class="op">=</span> {</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Monday'</span>: <span class="st">'Work'</span>,</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Tuesday'</span>: <span class="st">'Work'</span>,</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Wednesday'</span>: <span class="st">'Work'</span>,</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Thursday'</span>: <span class="st">'Work'</span>,</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Friday'</span>: <span class="st">'Work'</span>,</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Saturday'</span>: <span class="st">'Weekend'</span>,</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Sunday'</span>: <span class="st">'Weekend'</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>dic_to_series <span class="op">=</span> pandas.Series(weekdays_s,name<span class="op">=</span><span class="st">'Day_type'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="6ce9c9d6" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>dic_to_series</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>Monday          Work
Tuesday         Work
Wednesday       Work
Thursday        Work
Friday          Work
Saturday     Weekend
Sunday       Weekend
Name: Day_type, dtype: object</code></pre>
</div>
</div>
<p>Most <code>Pandas</code> operations and methods return <code>DataFrames</code> or <code>Series</code>. For instance, the <code>describe()</code> method, which returns basic statistics of numerical data, returns either a <code>DataFrame</code> or a <code>Series</code>.</p>
<div id="a990b0c9" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>df_arr[<span class="st">'A'</span>].describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>count    3.0
mean     4.0
std      3.0
min      1.0
25%      2.5
50%      4.0
75%      5.5
max      7.0
Name: A, dtype: float64</code></pre>
</div>
</div>
<div id="e0a6038a" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> df_arr[<span class="st">'A'</span>].describe() <span class="co"># I use describe on a series,  returns a series</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>pandas.core.series.Series</code></pre>
</div>
</div>
<div id="8e387951" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> df_arr[[<span class="st">'A'</span>]].describe()  <span class="co"># I use describe on a dataframe, returns a dataframe</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>pandas.core.frame.DataFrame</code></pre>
</div>
</div>
<div id="af01c67e" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">A</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>3.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>4.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>3.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>2.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>4.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>5.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>7.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
</section>
<section id="importing-and-exporting-data" class="level3" data-number="2.1.3">
<h3 data-number="2.1.3" class="anchored" data-anchor-id="importing-and-exporting-data"><span class="header-section-number">2.1.3</span> Importing and exporting data</h3>
<p>Besides creating our own tabular data, <code>Pandas</code> can be used to import and read data into <code>Pandas</code> own structures. Reading different file types (excel, parquets, json…) is supported by tha family of <code>read_*</code> functions. To illustrate it, let’s take a look to the credit car fraud data from <a href="https://www.kaggle.com/datasets/dhanushnarayananr/credit-card-fraud/data">Kaggle</a>.</p>
<p>First, we define the location of our data file. If you have a local copy of the course folder, you can specify the path as <code>../data/card_transdata.csv</code>. This path tells the program to start from the current working directory (i.e., the folder where this notebook is saved), move up one level, and then navigate to the data folder, where the <code>.csv</code> file is stored.</p>
<div id="9c1379e1" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>file_csv <span class="op">=</span><span class="st">'../data/card_transdata.csv'</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pandas.read_csv(file_csv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Printing the first or last <em>n</em> elements of the data is possible using the methods <code>.head(n)</code> and <code>.tail(n)</code>, for the first and bottom elements respectively.</p>
<div id="54d3d22b" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>data.head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">distance_from_home</th>
<th data-quarto-table-cell-role="th">distance_from_last_transaction</th>
<th data-quarto-table-cell-role="th">ratio_to_median_purchase_price</th>
<th data-quarto-table-cell-role="th">repeat_retailer</th>
<th data-quarto-table-cell-role="th">used_chip</th>
<th data-quarto-table-cell-role="th">used_pin_number</th>
<th data-quarto-table-cell-role="th">online_order</th>
<th data-quarto-table-cell-role="th">fraud</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>57.877857</td>
<td>0.311140</td>
<td>1.945940</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>10.829943</td>
<td>0.175592</td>
<td>1.294219</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>5.091079</td>
<td>0.805153</td>
<td>0.427715</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2.247564</td>
<td>5.600044</td>
<td>0.362663</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>44.190936</td>
<td>0.566486</td>
<td>2.222767</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<div id="09a53b20" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>data.tail(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">distance_from_home</th>
<th data-quarto-table-cell-role="th">distance_from_last_transaction</th>
<th data-quarto-table-cell-role="th">ratio_to_median_purchase_price</th>
<th data-quarto-table-cell-role="th">repeat_retailer</th>
<th data-quarto-table-cell-role="th">used_chip</th>
<th data-quarto-table-cell-role="th">used_pin_number</th>
<th data-quarto-table-cell-role="th">online_order</th>
<th data-quarto-table-cell-role="th">fraud</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">999995</td>
<td>2.207101</td>
<td>0.112651</td>
<td>1.626798</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">999996</td>
<td>19.872726</td>
<td>2.683904</td>
<td>2.778303</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">999997</td>
<td>2.914857</td>
<td>1.472687</td>
<td>0.218075</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">999998</td>
<td>4.258729</td>
<td>0.242023</td>
<td>0.475822</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">999999</td>
<td>58.108125</td>
<td>0.318110</td>
<td>0.386920</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>It is also possible to get all the particular data types specifications of our columns:</p>
<div id="cae65916" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>data.dtypes <span class="co"># it's an attribute of the dataframe</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>distance_from_home                float64
distance_from_last_transaction    float64
ratio_to_median_purchase_price    float64
repeat_retailer                   float64
used_chip                         float64
used_pin_number                   float64
online_order                      float64
fraud                             float64
dtype: object</code></pre>
</div>
</div>
<p>Or to get a quick technical summary of our imported data, we can use the <code>.info()</code> method</p>
<div id="e6d2b327" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>data.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 1000000 entries, 0 to 999999
Data columns (total 8 columns):
 #   Column                          Non-Null Count    Dtype  
---  ------                          --------------    -----  
 0   distance_from_home              1000000 non-null  float64
 1   distance_from_last_transaction  1000000 non-null  float64
 2   ratio_to_median_purchase_price  1000000 non-null  float64
 3   repeat_retailer                 1000000 non-null  float64
 4   used_chip                       1000000 non-null  float64
 5   used_pin_number                 1000000 non-null  float64
 6   online_order                    1000000 non-null  float64
 7   fraud                           1000000 non-null  float64
dtypes: float64(8)
memory usage: 61.0 MB</code></pre>
</div>
</div>
<p>The summary is telling us that:</p>
<ul>
<li>We have a <code>pandas.DataFrame</code>.</li>
<li>It has 1,000,000 rows and their index are from 0 to 999,9999</li>
<li>None of the collumns has missing data</li>
<li>All columns data type is a 64 bit float.</li>
<li>It takes up 61 megabytes of our RAM memory.</li>
</ul>
<p>While the <code>read_*</code> families allow to import different sources of data, the <code>to_*</code> allow to export it. In the below example, I am saving a csv that contains only the first 10 rows of the credit transaction data.</p>
<div id="4bdbc2fa" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>data.head(<span class="dv">10</span>).to_csv(<span class="st">'./subset.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If we export other data to the same file, it will typically overwrite the existing one (unless we are specifying sheets in an Excel file, for instance). Also, this happens without warning, so it is important to be consistent in our naming to avoid unwanted overwrites.</p>
<div id="003c0c3f" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>data.head(<span class="dv">5</span>).to_csv(<span class="st">'./subset.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="filtering-and-subsetting-dataframes." class="level3" data-number="2.1.4">
<h3 data-number="2.1.4" class="anchored" data-anchor-id="filtering-and-subsetting-dataframes."><span class="header-section-number">2.1.4</span> Filtering and subsetting dataframes.</h3>
<p>It is possible to use an approach similar to the selection of columns to be able to subset our dataframe to a given set of rows.</p>
<p>For example, let’s extract from the credit transaction data those that happened through online orders.</p>
<div id="dae9f815" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>online <span class="op">=</span> data[data[<span class="st">'online_order'</span>]<span class="op">==</span><span class="dv">1</span>]</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>online.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">distance_from_home</th>
<th data-quarto-table-cell-role="th">distance_from_last_transaction</th>
<th data-quarto-table-cell-role="th">ratio_to_median_purchase_price</th>
<th data-quarto-table-cell-role="th">repeat_retailer</th>
<th data-quarto-table-cell-role="th">used_chip</th>
<th data-quarto-table-cell-role="th">used_pin_number</th>
<th data-quarto-table-cell-role="th">online_order</th>
<th data-quarto-table-cell-role="th">fraud</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>5.091079</td>
<td>0.805153</td>
<td>0.427715</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2.247564</td>
<td>5.600044</td>
<td>0.362663</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>44.190936</td>
<td>0.566486</td>
<td>2.222767</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>3.724019</td>
<td>0.956838</td>
<td>0.278465</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9</td>
<td>8.839047</td>
<td>2.970512</td>
<td>2.361683</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>We can check that in our new subset the variable <strong>online_order</strong> is always 1.</p>
<div id="59f6161c" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>online[<span class="st">'online_order'</span>].describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code>count    650552.0
mean          1.0
std           0.0
min           1.0
25%           1.0
50%           1.0
75%           1.0
max           1.0
Name: online_order, dtype: float64</code></pre>
</div>
</div>
<div id="1d1ff005" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>online[<span class="st">'online_order'</span>].unique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>array([1.])</code></pre>
</div>
</div>
<p>That is, to select rows based on a column condition, we first write the condition within <code>[]</code>. This selection bracket will give use a series of boolean (i.e., a mask) with <code>True</code> values for those rows that satify the condition.</p>
<div id="39b5c0ed" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>mask_data <span class="op">=</span> data[<span class="st">'online_order'</span>]<span class="op">==</span><span class="dv">1</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>mask_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<pre><code>0         False
1         False
2          True
3          True
4          True
          ...  
999995    False
999996    False
999997     True
999998     True
999999     True
Name: online_order, Length: 1000000, dtype: bool</code></pre>
</div>
</div>
<div id="04063950" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(mask_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>pandas.core.series.Series</code></pre>
</div>
</div>
<p>Then, when we embrace that condition with the outer <code>[]</code> what we are doing is subsetting the original dataframe to those rows that are <code>True</code>, that is, that satisfy our condition.</p>
<p>If our condition involves two discrete values, we can write both conditions within the inner bracket using the <code>|</code> separator for <em>or</em> conditions and <code>&amp;</code> for <em>and</em>. That is, we could write <code>data[(data['var']==x) | (data['var']==y)]</code>. This line of code is equivalent to using the <code>.isin()</code> conditional function with argument <code>[x,y]</code>.</p>
<p>Sometimes, it is also useful to get rid of missing values on given columns using the <code>.notna()</code> method.</p>
<p>If we want to select rows and columns simultaneously, we can use the <code>.loc[condition,variable to keep]</code>and <code>.iloc[condition,variable to keep]</code> operators. For instance, to extract the distance from home only for the fraudulent transactions we could do:</p>
<div id="9f86db05" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>data.loc[data[<span class="st">'fraud'</span>]<span class="op">==</span><span class="dv">1</span>,<span class="st">'distance_from_home'</span>] <span class="co"># first element is the condition,  </span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>                                            <span class="co"># second one is the column we want. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<pre><code>13          2.131956
24          3.803057
29         15.694986
35         26.711462
36         10.664474
             ...    
999908     45.296658
999916    167.139756
999919    124.640118
999939     51.412900
999949     15.724799
Name: distance_from_home, Length: 87403, dtype: float64</code></pre>
</div>
</div>
<p><code>.loc</code> is also useful to replace the value of columns where a row satisfies certain condition. For instance, let’s create a new variable that takes value 1 only for those transactions happenning more than 5km away from home.</p>
<div id="2c0155a4" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>data[<span class="st">'more_5km'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>data.loc[data[<span class="st">'distance_from_home'</span>] <span class="op">&gt;</span> <span class="dv">5</span>, <span class="st">'more_5km'</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>data[data[<span class="st">'more_5km'</span>]<span class="op">==</span><span class="dv">1</span>][<span class="st">'distance_from_home'</span>].describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<pre><code>count    688790.000000
mean         37.534356
std          76.321463
min           5.000021
25%           9.407164
50%          17.527437
75%          37.590001
max       10632.723672
Name: distance_from_home, dtype: float64</code></pre>
</div>
</div>
<p>To extract using indexing of rows and columns we typically rely in <code>iloc</code> instead. In the snippet of code below, I am extracting the rows from 10 to 20 and the second and third column:</p>
<div id="6e5f72b1" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>data.iloc[<span class="dv">10</span>:<span class="dv">21</span>,<span class="dv">2</span>:<span class="dv">4</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ratio_to_median_purchase_price</th>
<th data-quarto-table-cell-role="th">repeat_retailer</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>1.136102</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>1.370330</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>0.551245</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>6.358667</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>2.798901</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>0.535640</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>0.516990</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>1.846451</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>2.530758</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>0.307217</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">20</td>
<td>1.838016</td>
<td>1.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>In whatever selection you are doing, keep in mind that the reasoning is always you first generate a <strong>mask</strong> and then you get the rows for which the mask holds.</p>
</section>
<section id="creating-new-columns" class="level3" data-number="2.1.5">
<h3 data-number="2.1.5" class="anchored" data-anchor-id="creating-new-columns"><span class="header-section-number">2.1.5</span> Creating new columns</h3>
<p><code>Pandas</code> operates with the traditional mathematical operators in an element-wise fashion, without the need of writing for loops. For instance, to convert the distance from kilometers to miles (i.e., we divide by 1.609)</p>
<div id="b8bd9ca9" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>data[<span class="st">'distance_from_home_km'</span>] <span class="op">=</span> data[<span class="st">'distance_from_home'</span>]<span class="op">/</span><span class="fl">1.609</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">distance_from_home</th>
<th data-quarto-table-cell-role="th">distance_from_last_transaction</th>
<th data-quarto-table-cell-role="th">ratio_to_median_purchase_price</th>
<th data-quarto-table-cell-role="th">repeat_retailer</th>
<th data-quarto-table-cell-role="th">used_chip</th>
<th data-quarto-table-cell-role="th">used_pin_number</th>
<th data-quarto-table-cell-role="th">online_order</th>
<th data-quarto-table-cell-role="th">fraud</th>
<th data-quarto-table-cell-role="th">more_5km</th>
<th data-quarto-table-cell-role="th">distance_from_home_km</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>57.877857</td>
<td>0.311140</td>
<td>1.945940</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1</td>
<td>35.971322</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>10.829943</td>
<td>0.175592</td>
<td>1.294219</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1</td>
<td>6.730853</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>5.091079</td>
<td>0.805153</td>
<td>0.427715</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1</td>
<td>3.164126</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2.247564</td>
<td>5.600044</td>
<td>0.362663</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0</td>
<td>1.396870</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>44.190936</td>
<td>0.566486</td>
<td>2.222767</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1</td>
<td>27.464845</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">999995</td>
<td>2.207101</td>
<td>0.112651</td>
<td>1.626798</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>1.371722</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">999996</td>
<td>19.872726</td>
<td>2.683904</td>
<td>2.778303</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1</td>
<td>12.350979</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">999997</td>
<td>2.914857</td>
<td>1.472687</td>
<td>0.218075</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0</td>
<td>1.811595</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">999998</td>
<td>4.258729</td>
<td>0.242023</td>
<td>0.475822</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0</td>
<td>2.646818</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">999999</td>
<td>58.108125</td>
<td>0.318110</td>
<td>0.386920</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1</td>
<td>36.114434</td>
</tr>
</tbody>
</table>

<p>1000000 rows × 10 columns</p>
</div>
</div>
</div>
</div>
<p>We can also operate with more than one columns. Let’s sum the indicators for repeat retailer and used chip so that we can get a new column that directly tell us if a row satisfies both conditions.</p>
<div id="d552395e" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>data[<span class="st">'sum_2'</span>] <span class="op">=</span> data[<span class="st">'repeat_retailer'</span>] <span class="op">+</span> data[<span class="st">'used_chip'</span>]</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">distance_from_home</th>
<th data-quarto-table-cell-role="th">distance_from_last_transaction</th>
<th data-quarto-table-cell-role="th">ratio_to_median_purchase_price</th>
<th data-quarto-table-cell-role="th">repeat_retailer</th>
<th data-quarto-table-cell-role="th">used_chip</th>
<th data-quarto-table-cell-role="th">used_pin_number</th>
<th data-quarto-table-cell-role="th">online_order</th>
<th data-quarto-table-cell-role="th">fraud</th>
<th data-quarto-table-cell-role="th">more_5km</th>
<th data-quarto-table-cell-role="th">distance_from_home_km</th>
<th data-quarto-table-cell-role="th">sum_2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>57.877857</td>
<td>0.311140</td>
<td>1.945940</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1</td>
<td>35.971322</td>
<td>2.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>10.829943</td>
<td>0.175592</td>
<td>1.294219</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1</td>
<td>6.730853</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>5.091079</td>
<td>0.805153</td>
<td>0.427715</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1</td>
<td>3.164126</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2.247564</td>
<td>5.600044</td>
<td>0.362663</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0</td>
<td>1.396870</td>
<td>2.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>44.190936</td>
<td>0.566486</td>
<td>2.222767</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1</td>
<td>27.464845</td>
<td>2.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">999995</td>
<td>2.207101</td>
<td>0.112651</td>
<td>1.626798</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>1.371722</td>
<td>2.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">999996</td>
<td>19.872726</td>
<td>2.683904</td>
<td>2.778303</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1</td>
<td>12.350979</td>
<td>2.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">999997</td>
<td>2.914857</td>
<td>1.472687</td>
<td>0.218075</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0</td>
<td>1.811595</td>
<td>2.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">999998</td>
<td>4.258729</td>
<td>0.242023</td>
<td>0.475822</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0</td>
<td>2.646818</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">999999</td>
<td>58.108125</td>
<td>0.318110</td>
<td>0.386920</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1</td>
<td>36.114434</td>
<td>2.0</td>
</tr>
</tbody>
</table>

<p>1000000 rows × 11 columns</p>
</div>
</div>
</div>
</div>
<p>Because <em>sum_2</em> is not a very intuitive name, let’s take advantage of that to show we can rename columns:</p>
<div id="346f262b" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> data.rename(columns<span class="op">=</span>{<span class="st">'sum_2'</span>:<span class="st">'both_conditions'</span>})</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">distance_from_home</th>
<th data-quarto-table-cell-role="th">distance_from_last_transaction</th>
<th data-quarto-table-cell-role="th">ratio_to_median_purchase_price</th>
<th data-quarto-table-cell-role="th">repeat_retailer</th>
<th data-quarto-table-cell-role="th">used_chip</th>
<th data-quarto-table-cell-role="th">used_pin_number</th>
<th data-quarto-table-cell-role="th">online_order</th>
<th data-quarto-table-cell-role="th">fraud</th>
<th data-quarto-table-cell-role="th">more_5km</th>
<th data-quarto-table-cell-role="th">distance_from_home_km</th>
<th data-quarto-table-cell-role="th">both_conditions</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>57.877857</td>
<td>0.311140</td>
<td>1.945940</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1</td>
<td>35.971322</td>
<td>2.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>10.829943</td>
<td>0.175592</td>
<td>1.294219</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1</td>
<td>6.730853</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>5.091079</td>
<td>0.805153</td>
<td>0.427715</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1</td>
<td>3.164126</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2.247564</td>
<td>5.600044</td>
<td>0.362663</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0</td>
<td>1.396870</td>
<td>2.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>44.190936</td>
<td>0.566486</td>
<td>2.222767</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1</td>
<td>27.464845</td>
<td>2.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">999995</td>
<td>2.207101</td>
<td>0.112651</td>
<td>1.626798</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>1.371722</td>
<td>2.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">999996</td>
<td>19.872726</td>
<td>2.683904</td>
<td>2.778303</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1</td>
<td>12.350979</td>
<td>2.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">999997</td>
<td>2.914857</td>
<td>1.472687</td>
<td>0.218075</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0</td>
<td>1.811595</td>
<td>2.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">999998</td>
<td>4.258729</td>
<td>0.242023</td>
<td>0.475822</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0</td>
<td>2.646818</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">999999</td>
<td>58.108125</td>
<td>0.318110</td>
<td>0.386920</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1</td>
<td>36.114434</td>
<td>2.0</td>
</tr>
</tbody>
</table>

<p>1000000 rows × 11 columns</p>
</div>
</div>
</div>
</div>
</section>
<section id="merging-tables." class="level3" data-number="2.1.6">
<h3 data-number="2.1.6" class="anchored" data-anchor-id="merging-tables."><span class="header-section-number">2.1.6</span> Merging tables.</h3>
<p>Sometimes, we find that in the process of cleaning data, we need to put together different <code>DataFrames</code>, either vertically or horizontally. This can be achieved concatenating along indexes or, when the dataframes have a common identifier, using <code>.merge()</code></p>
<p>Let’s start to show we can concatenate along axis. The default axis is 0, which means that it will concatenate rows (i.e., append dataframes vertically)</p>
<div id="4598e925" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>data_1 <span class="op">=</span> data.iloc[<span class="dv">0</span>:<span class="dv">100</span>]</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>data_2 <span class="op">=</span> data.iloc[<span class="dv">100</span>:<span class="dv">200</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="8e769b5b" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>concat_rows <span class="op">=</span> pandas.concat([data_1,data_2], axis <span class="op">=</span> <span class="dv">0</span>)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>concat_rows </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">distance_from_home</th>
<th data-quarto-table-cell-role="th">distance_from_last_transaction</th>
<th data-quarto-table-cell-role="th">ratio_to_median_purchase_price</th>
<th data-quarto-table-cell-role="th">repeat_retailer</th>
<th data-quarto-table-cell-role="th">used_chip</th>
<th data-quarto-table-cell-role="th">used_pin_number</th>
<th data-quarto-table-cell-role="th">online_order</th>
<th data-quarto-table-cell-role="th">fraud</th>
<th data-quarto-table-cell-role="th">more_5km</th>
<th data-quarto-table-cell-role="th">distance_from_home_km</th>
<th data-quarto-table-cell-role="th">both_conditions</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>57.877857</td>
<td>0.311140</td>
<td>1.945940</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1</td>
<td>35.971322</td>
<td>2.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>10.829943</td>
<td>0.175592</td>
<td>1.294219</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1</td>
<td>6.730853</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>5.091079</td>
<td>0.805153</td>
<td>0.427715</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1</td>
<td>3.164126</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2.247564</td>
<td>5.600044</td>
<td>0.362663</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0</td>
<td>1.396870</td>
<td>2.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>44.190936</td>
<td>0.566486</td>
<td>2.222767</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1</td>
<td>27.464845</td>
<td>2.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">195</td>
<td>45.031736</td>
<td>0.055077</td>
<td>1.312067</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1</td>
<td>27.987406</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">196</td>
<td>242.913187</td>
<td>4.424776</td>
<td>0.741428</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1</td>
<td>150.971527</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">197</td>
<td>4.586564</td>
<td>3.365070</td>
<td>2.454288</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>2.850568</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">198</td>
<td>19.153042</td>
<td>0.403533</td>
<td>1.111563</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1</td>
<td>11.903693</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">199</td>
<td>0.718005</td>
<td>10.054520</td>
<td>1.341927</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0.446243</td>
<td>1.0</td>
</tr>
</tbody>
</table>

<p>200 rows × 11 columns</p>
</div>
</div>
</div>
</div>
<p>If instead we try to concatenate horizontally, it will by default try to concatenate with the index (unless we specify <code>ignore_index=True</code>). In the below example, since the columns are subset in different set of rows, it just fills with <code>NaN</code> the rows that do not share an index in the other dataframe. We can also use custom columns to align the dataframes specifying the column name in the ‘keys’ options</p>
<div id="bb8ec3a2" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>data_c1 <span class="op">=</span>data_1[[<span class="st">'distance_from_home'</span>,<span class="st">'repeat_retailer'</span> ]]</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>data_c2 <span class="op">=</span>data_2[[<span class="st">'distance_from_last_transaction'</span>,<span class="st">'used_chip'</span> ]]</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>data_ch <span class="op">=</span> pandas.concat([data_c1,data_c2],axis <span class="op">=</span> <span class="dv">1</span>) </span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>data_ch </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">distance_from_home</th>
<th data-quarto-table-cell-role="th">repeat_retailer</th>
<th data-quarto-table-cell-role="th">distance_from_last_transaction</th>
<th data-quarto-table-cell-role="th">used_chip</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>57.877857</td>
<td>1.0</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>10.829943</td>
<td>1.0</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>5.091079</td>
<td>1.0</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2.247564</td>
<td>1.0</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>44.190936</td>
<td>1.0</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">195</td>
<td>NaN</td>
<td>NaN</td>
<td>0.055077</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">196</td>
<td>NaN</td>
<td>NaN</td>
<td>4.424776</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">197</td>
<td>NaN</td>
<td>NaN</td>
<td>3.365070</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">198</td>
<td>NaN</td>
<td>NaN</td>
<td>0.403533</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">199</td>
<td>NaN</td>
<td>NaN</td>
<td>10.054520</td>
<td>1.0</td>
</tr>
</tbody>
</table>

<p>200 rows × 4 columns</p>
</div>
</div>
</div>
</div>
<p>Using concat for horizontal concatenation can be very useful when we have more than one dataset to concatenate and want to avoid repeated lines using <code>.merge</code>, which by default can only concatenate two dataframes.</p>
<div id="acc3c510" class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>data_c1 <span class="op">=</span>data_1[[<span class="st">'distance_from_home'</span>,<span class="st">'repeat_retailer'</span> ]]</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>data_c2 <span class="op">=</span>data_1[[<span class="st">'distance_from_last_transaction'</span>,<span class="st">'used_chip'</span> ]]</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>data_c3 <span class="op">=</span>data_1[[<span class="st">'used_pin_number'</span>,<span class="st">'online_order'</span>]]</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>data_ch <span class="op">=</span> pandas.concat([data_c1,data_c2,data_c3],axis <span class="op">=</span> <span class="dv">1</span>) </span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>data_ch </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="44">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">distance_from_home</th>
<th data-quarto-table-cell-role="th">repeat_retailer</th>
<th data-quarto-table-cell-role="th">distance_from_last_transaction</th>
<th data-quarto-table-cell-role="th">used_chip</th>
<th data-quarto-table-cell-role="th">used_pin_number</th>
<th data-quarto-table-cell-role="th">online_order</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>57.877857</td>
<td>1.0</td>
<td>0.311140</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>10.829943</td>
<td>1.0</td>
<td>0.175592</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>5.091079</td>
<td>1.0</td>
<td>0.805153</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2.247564</td>
<td>1.0</td>
<td>5.600044</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>44.190936</td>
<td>1.0</td>
<td>0.566486</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">95</td>
<td>11.411763</td>
<td>1.0</td>
<td>2.233248</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">96</td>
<td>2.987854</td>
<td>1.0</td>
<td>9.315192</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">97</td>
<td>0.530985</td>
<td>0.0</td>
<td>1.501575</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">98</td>
<td>6.136181</td>
<td>1.0</td>
<td>2.579574</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">99</td>
<td>1.532551</td>
<td>0.0</td>
<td>3.097159</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
</tbody>
</table>

<p>100 rows × 6 columns</p>
</div>
</div>
</div>
</div>
<p>If instead we wanted to use the <code>.merge()</code> method, we would have to repeat it twice:</p>
<div id="e0ece5d2" class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>data_m1 <span class="op">=</span> data_c1.reset_index().merge(</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>                                data_c2.reset_index(),</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>                                on<span class="op">=</span><span class="st">'index'</span>,</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>                                how<span class="op">=</span><span class="st">'inner'</span>,</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>                                validate<span class="op">=</span><span class="st">'1:1'</span>)</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>data_m1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="45">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">index</th>
<th data-quarto-table-cell-role="th">distance_from_home</th>
<th data-quarto-table-cell-role="th">repeat_retailer</th>
<th data-quarto-table-cell-role="th">distance_from_last_transaction</th>
<th data-quarto-table-cell-role="th">used_chip</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>57.877857</td>
<td>1.0</td>
<td>0.311140</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>10.829943</td>
<td>1.0</td>
<td>0.175592</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2</td>
<td>5.091079</td>
<td>1.0</td>
<td>0.805153</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>3</td>
<td>2.247564</td>
<td>1.0</td>
<td>5.600044</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>4</td>
<td>44.190936</td>
<td>1.0</td>
<td>0.566486</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">95</td>
<td>95</td>
<td>11.411763</td>
<td>1.0</td>
<td>2.233248</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">96</td>
<td>96</td>
<td>2.987854</td>
<td>1.0</td>
<td>9.315192</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">97</td>
<td>97</td>
<td>0.530985</td>
<td>0.0</td>
<td>1.501575</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">98</td>
<td>98</td>
<td>6.136181</td>
<td>1.0</td>
<td>2.579574</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">99</td>
<td>99</td>
<td>1.532551</td>
<td>0.0</td>
<td>3.097159</td>
<td>1.0</td>
</tr>
</tbody>
</table>

<p>100 rows × 5 columns</p>
</div>
</div>
</div>
</div>
<div id="e75e2081" class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>data_m1 <span class="op">=</span> data_m1.merge(data_c3.reset_index(),</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>                        on<span class="op">=</span><span class="st">'index'</span>,</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>                        how<span class="op">=</span><span class="st">'inner'</span>,</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>                        validate<span class="op">=</span><span class="st">'1:1'</span>)</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>data_m1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="46">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">index</th>
<th data-quarto-table-cell-role="th">distance_from_home</th>
<th data-quarto-table-cell-role="th">repeat_retailer</th>
<th data-quarto-table-cell-role="th">distance_from_last_transaction</th>
<th data-quarto-table-cell-role="th">used_chip</th>
<th data-quarto-table-cell-role="th">used_pin_number</th>
<th data-quarto-table-cell-role="th">online_order</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>57.877857</td>
<td>1.0</td>
<td>0.311140</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>10.829943</td>
<td>1.0</td>
<td>0.175592</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2</td>
<td>5.091079</td>
<td>1.0</td>
<td>0.805153</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>3</td>
<td>2.247564</td>
<td>1.0</td>
<td>5.600044</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>4</td>
<td>44.190936</td>
<td>1.0</td>
<td>0.566486</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">95</td>
<td>95</td>
<td>11.411763</td>
<td>1.0</td>
<td>2.233248</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">96</td>
<td>96</td>
<td>2.987854</td>
<td>1.0</td>
<td>9.315192</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">97</td>
<td>97</td>
<td>0.530985</td>
<td>0.0</td>
<td>1.501575</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">98</td>
<td>98</td>
<td>6.136181</td>
<td>1.0</td>
<td>2.579574</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">99</td>
<td>99</td>
<td>1.532551</td>
<td>0.0</td>
<td>3.097159</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
</tbody>
</table>

<p>100 rows × 7 columns</p>
</div>
</div>
</div>
</div>
</section>
<section id="summary-statistics-and-groupby-operations." class="level3" data-number="2.1.7">
<h3 data-number="2.1.7" class="anchored" data-anchor-id="summary-statistics-and-groupby-operations."><span class="header-section-number">2.1.7</span> Summary statistics and groupby operations.</h3>
<p><code>Pandas</code> also offers various statistical measures that can be applied to numerical data columns. By default, operations exclude missing data and extend across rows.</p>
<div id="75e28dbf" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Mean distance from home:'</span>, data[<span class="st">'distance_from_home'</span>].mean())</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Minimum distance from home:'</span>,data[<span class="st">'distance_from_home'</span>].<span class="bu">min</span>())</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Median distance from home:'</span>, data[<span class="st">'distance_from_home'</span>].median())</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Maximum distance from home:'</span>, data[<span class="st">'distance_from_home'</span>].<span class="bu">max</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean distance from home: 26.62879219257128
Minimum distance from home: 0.0048743850667442
Median distance from home: 9.967760078697681
Maximum distance from home: 10632.723672241103</code></pre>
</div>
</div>
<p>If we want more flexibility we can also specify a series of statistics and the columns we want them to be computed on using <code>.agg</code></p>
<div id="03e192f5" class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>data.agg(</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>           <span class="st">"distance_from_home"</span>: [<span class="st">"min"</span>, <span class="st">"max"</span>, <span class="st">"median"</span>, <span class="st">"skew"</span>],</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>            <span class="st">"distance_from_last_transaction"</span>: [ <span class="st">"max"</span>, <span class="st">"median"</span>, <span class="st">"mean"</span>],  </span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>       }</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="48">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">distance_from_home</th>
<th data-quarto-table-cell-role="th">distance_from_last_transaction</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">min</td>
<td>0.004874</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>10632.723672</td>
<td>11851.104565</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">median</td>
<td>9.967760</td>
<td>0.998650</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">skew</td>
<td>20.239733</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">mean</td>
<td>NaN</td>
<td>5.036519</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Computing the mean of a dummy variable will tell us the percentage of observations within that category.</p>
</div>
</div>
<div id="a95ef369" class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>data[<span class="st">'fraud'</span>].mean()  <span class="co">## 8% are frauds. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="49">
<pre><code>0.087403</code></pre>
</div>
</div>
<p>Besides these aggreggating operations, we can also compute them within category or by groups.</p>
<div id="47c8e9f4" class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>data.groupby(<span class="st">"fraud"</span>)[<span class="st">"distance_from_home"</span>].mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="50">
<pre><code>fraud
0.0    22.832976
1.0    66.261876
Name: distance_from_home, dtype: float64</code></pre>
</div>
</div>
<p>Because the default return is a <code>pandas.Series</code>, it is useful to convert it to a <code>pandas.DataFrame</code> which can be done as follows:</p>
<div id="a5c80844" class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>pandas.DataFrame(data.groupby(<span class="st">"fraud"</span>)[<span class="st">"distance_from_home"</span>].mean())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="51">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">distance_from_home</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">fraud</th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0.0</td>
<td>22.832976</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1.0</td>
<td>66.261876</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>Notice that the new indexing variable is automatically set to our groupby one. We can undo this change to recover the groupby variable as accessible:</p>
<div id="f0c3288e" class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>pandas.DataFrame(data.groupby(<span class="st">"fraud"</span>)[<span class="st">"distance_from_home"</span>].mean()).reset_index()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="52">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">fraud</th>
<th data-quarto-table-cell-role="th">distance_from_home</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.0</td>
<td>22.832976</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1.0</td>
<td>66.261876</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
</section>
</section>
<section id="visualization-matplotlib-and-seaborn." class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="visualization-matplotlib-and-seaborn."><span class="header-section-number">2.2</span> Visualization: Matplotlib and Seaborn.</h2>
<p>The library that will allow us to do data visualization, whether static, animated or interactive, in Python is <code>Matplotlib</code>.</p>
<p><code>Matplotlib</code> plots our data on Figures, each one containing axes where data points are defined as x-y coordinates. This means that matplotlib will allow us to manipulate the displays by changing the elements of these two classes:</p>
<p><strong>Figure</strong>:</p>
<p>The entire figure that contains the axes, which are the actual plots.</p>
<p><strong>Axes</strong>:</p>
<p>Contains a region for plotting data, and include the x and y axis (and z if is 3D) where we actually plot the data. The figure below, from the package original documentation, illustrates all the elements within a figure.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../img/anatomy.jpg" class="img-fluid figure-img"></p>
<figcaption>Source : Matplotlib documentation</figcaption>
</figure>
</div>
<div id="bc9ce577" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For the following examples, we will use data different from the crad transaction. However, just as in most typical real life situations, we will have to do some pre-processing before we can start plotting our data. In this case, we are going to be using data from the <a href="https://www.who.int/data/gho/data/indicators/indicator-details/GHO/ambient-and-household-air-pollution-attributable-death-rate-(per-100-000-population-age-standardized)">World Health Organization</a> on mortality induced by pollution and country GDP per capita data from the <a href="https://ourworldindata.org/grapher/gdp-per-capita-worldbank?tab=table&amp;time=2019..latest">World Bank</a></p>
<div id="67f5a7f3" class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>death_rate <span class="op">=</span> pandas.read_csv(<span class="st">'../data/data.csv'</span>)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>gdp <span class="op">=</span> pandas.read_csv(<span class="st">'../data/gdp-per-capita-worldbank.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="2f344c60" class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>death_rate[(death_rate[<span class="st">'Location'</span>]<span class="op">==</span><span class="st">'Algeria'</span>) </span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>            <span class="op">&amp;</span> (death_rate[<span class="st">'Dim1'</span>]<span class="op">==</span><span class="st">'Both sexes'</span>) </span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>            <span class="op">&amp;</span> (death_rate[<span class="st">'Dim2'</span>]<span class="op">==</span><span class="st">'Total'</span>) </span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>            <span class="op">&amp;</span> (death_rate[<span class="st">'IndicatorCode'</span>]<span class="op">==</span><span class="st">'SDGAIRBOD'</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="55">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">IndicatorCode</th>
<th data-quarto-table-cell-role="th">Indicator</th>
<th data-quarto-table-cell-role="th">ValueType</th>
<th data-quarto-table-cell-role="th">ParentLocationCode</th>
<th data-quarto-table-cell-role="th">ParentLocation</th>
<th data-quarto-table-cell-role="th">Location type</th>
<th data-quarto-table-cell-role="th">SpatialDimValueCode</th>
<th data-quarto-table-cell-role="th">Location</th>
<th data-quarto-table-cell-role="th">Period type</th>
<th data-quarto-table-cell-role="th">Period</th>
<th data-quarto-table-cell-role="th">IsLatestYear</th>
<th data-quarto-table-cell-role="th">Dim1 type</th>
<th data-quarto-table-cell-role="th">Dim1</th>
<th data-quarto-table-cell-role="th">Dim1ValueCode</th>
<th data-quarto-table-cell-role="th">Dim2 type</th>
<th data-quarto-table-cell-role="th">Dim2</th>
<th data-quarto-table-cell-role="th">Dim2ValueCode</th>
<th data-quarto-table-cell-role="th">Dim3 type</th>
<th data-quarto-table-cell-role="th">Dim3</th>
<th data-quarto-table-cell-role="th">Dim3ValueCode</th>
<th data-quarto-table-cell-role="th">DataSourceDimValueCode</th>
<th data-quarto-table-cell-role="th">DataSource</th>
<th data-quarto-table-cell-role="th">FactValueNumericPrefix</th>
<th data-quarto-table-cell-role="th">FactValueNumeric</th>
<th data-quarto-table-cell-role="th">FactValueUoM</th>
<th data-quarto-table-cell-role="th">FactValueNumericLowPrefix</th>
<th data-quarto-table-cell-role="th">FactValueNumericLow</th>
<th data-quarto-table-cell-role="th">FactValueNumericHighPrefix</th>
<th data-quarto-table-cell-role="th">FactValueNumericHigh</th>
<th data-quarto-table-cell-role="th">Value</th>
<th data-quarto-table-cell-role="th">FactValueTranslationID</th>
<th data-quarto-table-cell-role="th">FactComments</th>
<th data-quarto-table-cell-role="th">Language</th>
<th data-quarto-table-cell-role="th">DateModified</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">2342</td>
<td>SDGAIRBOD</td>
<td>Ambient and household air pollution attributab...</td>
<td>numeric</td>
<td>AFR</td>
<td>Africa</td>
<td>Country</td>
<td>DZA</td>
<td>Algeria</td>
<td>Year</td>
<td>2019</td>
<td>True</td>
<td>Sex</td>
<td>Both sexes</td>
<td>SEX_BTSX</td>
<td>Cause</td>
<td>Total</td>
<td>ENVCAUSE_ENVCAUSE000</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>41.43</td>
<td>NaN</td>
<td>NaN</td>
<td>28.46</td>
<td>NaN</td>
<td>55.68</td>
<td>41 [28-56]</td>
<td>NaN</td>
<td>NaN</td>
<td>EN</td>
<td>2022-08-25T22:00:00.000Z</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>We keep the variables we are interested in.</p>
<div id="38c12ee4" class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>keep_vars <span class="op">=</span> [<span class="st">'Indicator'</span>,<span class="st">'Location'</span>,<span class="st">'ParentLocationCode'</span>,</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>            <span class="st">'ParentLocation'</span>,<span class="st">'SpatialDimValueCode'</span>,</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Location'</span>,<span class="st">'FactValueNumeric'</span>]</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>death_rate <span class="op">=</span> death_rate[(death_rate[<span class="st">'Dim1'</span>]<span class="op">==</span><span class="st">'Both sexes'</span>) </span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>                        <span class="op">&amp;</span> (death_rate[<span class="st">'Dim2'</span>]<span class="op">==</span><span class="st">'Total'</span>) </span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>                        <span class="op">&amp;</span> (death_rate[<span class="st">'IndicatorCode'</span>]<span class="op">==</span><span class="st">'SDGAIRBOD'</span>)][keep_vars]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="c03a43ba" class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>death_rate</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="57">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Indicator</th>
<th data-quarto-table-cell-role="th">Location</th>
<th data-quarto-table-cell-role="th">ParentLocationCode</th>
<th data-quarto-table-cell-role="th">ParentLocation</th>
<th data-quarto-table-cell-role="th">SpatialDimValueCode</th>
<th data-quarto-table-cell-role="th">Location</th>
<th data-quarto-table-cell-role="th">FactValueNumeric</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">389</td>
<td>Ambient and household air pollution attributab...</td>
<td>Bahamas</td>
<td>AMR</td>
<td>Americas</td>
<td>BHS</td>
<td>Bahamas</td>
<td>10.04</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">450</td>
<td>Ambient and household air pollution attributab...</td>
<td>Democratic Republic of the Congo</td>
<td>AFR</td>
<td>Africa</td>
<td>COD</td>
<td>Democratic Republic of the Congo</td>
<td>100.30</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">453</td>
<td>Ambient and household air pollution attributab...</td>
<td>Afghanistan</td>
<td>EMR</td>
<td>Eastern Mediterranean</td>
<td>AFG</td>
<td>Afghanistan</td>
<td>100.80</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">454</td>
<td>Ambient and household air pollution attributab...</td>
<td>Bangladesh</td>
<td>SEAR</td>
<td>South-East Asia</td>
<td>BGD</td>
<td>Bangladesh</td>
<td>100.90</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">456</td>
<td>Ambient and household air pollution attributab...</td>
<td>Mozambique</td>
<td>AFR</td>
<td>Africa</td>
<td>MOZ</td>
<td>Mozambique</td>
<td>102.50</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3272</td>
<td>Ambient and household air pollution attributab...</td>
<td>Papua New Guinea</td>
<td>WPR</td>
<td>Western Pacific</td>
<td>PNG</td>
<td>Papua New Guinea</td>
<td>94.90</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3277</td>
<td>Ambient and household air pollution attributab...</td>
<td>Sao Tome and Principe</td>
<td>AFR</td>
<td>Africa</td>
<td>STP</td>
<td>Sao Tome and Principe</td>
<td>95.96</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3278</td>
<td>Ambient and household air pollution attributab...</td>
<td>Togo</td>
<td>AFR</td>
<td>Africa</td>
<td>TGO</td>
<td>Togo</td>
<td>96.39</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3285</td>
<td>Ambient and household air pollution attributab...</td>
<td>Republic of Moldova</td>
<td>EUR</td>
<td>Europe</td>
<td>MDA</td>
<td>Republic of Moldova</td>
<td>98.45</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3291</td>
<td>Ambient and household air pollution attributab...</td>
<td>Hungary</td>
<td>EUR</td>
<td>Europe</td>
<td>HUN</td>
<td>Hungary</td>
<td>99.49</td>
</tr>
</tbody>
</table>

<p>183 rows × 7 columns</p>
</div>
</div>
</div>
</div>
<div id="3a17f9b6" class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>gdp.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="58">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Entity</th>
<th data-quarto-table-cell-role="th">Code</th>
<th data-quarto-table-cell-role="th">Year</th>
<th data-quarto-table-cell-role="th">GDP per capita, PPP (constant 2017 international $)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Afghanistan</td>
<td>AFG</td>
<td>2002</td>
<td>1280.4631</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Afghanistan</td>
<td>AFG</td>
<td>2003</td>
<td>1292.3335</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Afghanistan</td>
<td>AFG</td>
<td>2004</td>
<td>1260.0605</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Afghanistan</td>
<td>AFG</td>
<td>2005</td>
<td>1352.3207</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Afghanistan</td>
<td>AFG</td>
<td>2006</td>
<td>1366.9932</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<div id="d1b44f29" class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>gdp <span class="op">=</span> gdp[(gdp[<span class="st">'Year'</span>]<span class="op">==</span><span class="dv">2019</span>) <span class="op">&amp;</span> </span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>            (gdp[<span class="st">'Code'</span>].notna()) <span class="op">&amp;</span> (gdp[<span class="st">'Code'</span>]<span class="op">!=</span><span class="st">'World'</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="c204e0b1" class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>gdp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="60">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Entity</th>
<th data-quarto-table-cell-role="th">Code</th>
<th data-quarto-table-cell-role="th">Year</th>
<th data-quarto-table-cell-role="th">GDP per capita, PPP (constant 2017 international $)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">17</td>
<td>Afghanistan</td>
<td>AFG</td>
<td>2019</td>
<td>2079.9219</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">49</td>
<td>Albania</td>
<td>ALB</td>
<td>2019</td>
<td>13655.6650</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">81</td>
<td>Algeria</td>
<td>DZA</td>
<td>2019</td>
<td>11627.2800</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">113</td>
<td>Angola</td>
<td>AGO</td>
<td>2019</td>
<td>6602.4240</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">145</td>
<td>Antigua and Barbuda</td>
<td>ATG</td>
<td>2019</td>
<td>23035.6580</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6215</td>
<td>Vanuatu</td>
<td>VUT</td>
<td>2019</td>
<td>3070.3508</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6247</td>
<td>Vietnam</td>
<td>VNM</td>
<td>2019</td>
<td>10252.0050</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6279</td>
<td>World</td>
<td>OWID_WRL</td>
<td>2019</td>
<td>16847.4600</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6311</td>
<td>Zambia</td>
<td>ZMB</td>
<td>2019</td>
<td>3372.3590</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6343</td>
<td>Zimbabwe</td>
<td>ZWE</td>
<td>2019</td>
<td>2203.3967</td>
</tr>
</tbody>
</table>

<p>194 rows × 4 columns</p>
</div>
</div>
</div>
</div>
<p>Now we are ready to merge both.</p>
<div id="d84abc96" class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-overflow-wrap code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>gdp_pollution <span class="op">=</span> gdp.merge(death_rate, </span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>                        left_on<span class="op">=</span><span class="st">'Code'</span>,</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>                        right_on<span class="op">=</span><span class="st">'SpatialDimValueCode'</span>,</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>                        how<span class="op">=</span><span class="st">'inner'</span>,validate<span class="op">=</span><span class="st">'1:1'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="d65d1a8e" class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>gdp_pollution</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="62">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Entity</th>
<th data-quarto-table-cell-role="th">Code</th>
<th data-quarto-table-cell-role="th">Year</th>
<th data-quarto-table-cell-role="th">GDP per capita, PPP (constant 2017 international $)</th>
<th data-quarto-table-cell-role="th">Indicator</th>
<th data-quarto-table-cell-role="th">Location</th>
<th data-quarto-table-cell-role="th">ParentLocationCode</th>
<th data-quarto-table-cell-role="th">ParentLocation</th>
<th data-quarto-table-cell-role="th">SpatialDimValueCode</th>
<th data-quarto-table-cell-role="th">Location</th>
<th data-quarto-table-cell-role="th">FactValueNumeric</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Afghanistan</td>
<td>AFG</td>
<td>2019</td>
<td>2079.9219</td>
<td>Ambient and household air pollution attributab...</td>
<td>Afghanistan</td>
<td>EMR</td>
<td>Eastern Mediterranean</td>
<td>AFG</td>
<td>Afghanistan</td>
<td>100.80</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Albania</td>
<td>ALB</td>
<td>2019</td>
<td>13655.6650</td>
<td>Ambient and household air pollution attributab...</td>
<td>Albania</td>
<td>EUR</td>
<td>Europe</td>
<td>ALB</td>
<td>Albania</td>
<td>164.80</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Algeria</td>
<td>DZA</td>
<td>2019</td>
<td>11627.2800</td>
<td>Ambient and household air pollution attributab...</td>
<td>Algeria</td>
<td>AFR</td>
<td>Africa</td>
<td>DZA</td>
<td>Algeria</td>
<td>41.43</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Angola</td>
<td>AGO</td>
<td>2019</td>
<td>6602.4240</td>
<td>Ambient and household air pollution attributab...</td>
<td>Angola</td>
<td>AFR</td>
<td>Africa</td>
<td>AGO</td>
<td>Angola</td>
<td>59.47</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Antigua and Barbuda</td>
<td>ATG</td>
<td>2019</td>
<td>23035.6580</td>
<td>Ambient and household air pollution attributab...</td>
<td>Antigua and Barbuda</td>
<td>AMR</td>
<td>Americas</td>
<td>ATG</td>
<td>Antigua and Barbuda</td>
<td>21.54</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">171</td>
<td>Uzbekistan</td>
<td>UZB</td>
<td>2019</td>
<td>7348.1470</td>
<td>Ambient and household air pollution attributab...</td>
<td>Uzbekistan</td>
<td>EUR</td>
<td>Europe</td>
<td>UZB</td>
<td>Uzbekistan</td>
<td>93.10</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">172</td>
<td>Vanuatu</td>
<td>VUT</td>
<td>2019</td>
<td>3070.3508</td>
<td>Ambient and household air pollution attributab...</td>
<td>Vanuatu</td>
<td>WPR</td>
<td>Western Pacific</td>
<td>VUT</td>
<td>Vanuatu</td>
<td>138.20</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">173</td>
<td>Vietnam</td>
<td>VNM</td>
<td>2019</td>
<td>10252.0050</td>
<td>Ambient and household air pollution attributab...</td>
<td>Viet Nam</td>
<td>WPR</td>
<td>Western Pacific</td>
<td>VNM</td>
<td>Viet Nam</td>
<td>107.80</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">174</td>
<td>Zambia</td>
<td>ZMB</td>
<td>2019</td>
<td>3372.3590</td>
<td>Ambient and household air pollution attributab...</td>
<td>Zambia</td>
<td>AFR</td>
<td>Africa</td>
<td>ZMB</td>
<td>Zambia</td>
<td>63.04</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">175</td>
<td>Zimbabwe</td>
<td>ZWE</td>
<td>2019</td>
<td>2203.3967</td>
<td>Ambient and household air pollution attributab...</td>
<td>Zimbabwe</td>
<td>AFR</td>
<td>Africa</td>
<td>ZWE</td>
<td>Zimbabwe</td>
<td>80.64</td>
</tr>
</tbody>
</table>

<p>176 rows × 11 columns</p>
</div>
</div>
</div>
</div>
<p>For a quick visualization, we can use the <code>Pandas.plot()</code> method, that will generate a Matplotlib figure object. Our sample data is more complicated because we don’t have an X axis directly, so we will have a line graph, where the X axis is the index (i.e., row indicator) and the Y axis is the value we are plotting.</p>
<div id="d206d8df" class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>gdp_pollution[<span class="st">'FactValueNumeric'</span>].plot()</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="section2_files/figure-html/cell-64-output-1.png" width="575" height="411" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>But this is not very informative. Let’s exploit the functionalities of the <code>.plot()</code> method to get a better grasp of our data.</p>
<div id="2cfefc5c" class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-overflow-wrap code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>gdp_pollution.plot.scatter(x<span class="op">=</span><span class="st">'GDP per capita, PPP (constant 2017 international $)'</span>,</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>                           y<span class="op">=</span><span class="st">'FactValueNumeric'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="section2_files/figure-html/cell-65-output-1.png" width="618" height="429" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>This scatterplot is starting to say something: it seems there is a negative relationship between GDP per capita and deaths due to pollution. We would have been able to produce the same graph to using <code>Matplotlib</code> functionalities as follows:</p>
<div id="b29143c8" class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-overflow-wrap code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>plt.plot(gdp_pollution[<span class="st">'GDP per capita, PPP (constant 2017 international $)'</span>],gdp_pollution[<span class="st">'FactValueNumeric'</span>],<span class="st">'o'</span>) <span class="co">#'o' = scatterplot</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'GDP Per Capita'</span>)  </span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Air pollution attributable death rate (per 100 000 population)'</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="65">
<pre><code>Text(0, 0.5, 'Air pollution attributable death rate (per 100 000 population)')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="section2_files/figure-html/cell-66-output-2.png" width="618" height="429" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>While the <code>Pandas</code> functionality allows us to do direct visualizations, further customizations will be required most of the time to achieve the desired output. This is when Matplotlib comes in handy.</p>
<div id="d0e1fed4" class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-overflow-wrap code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>f, axs <span class="op">=</span> plt.subplots(figsize <span class="op">=</span> (<span class="dv">5</span>,<span class="dv">5</span>)) <span class="co"># in inches. We can define a converting factor</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>gdp_pollution.plot(ax<span class="op">=</span>axs, </span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>                    x <span class="op">=</span><span class="st">'GDP per capita, PPP (constant 2017 international $)'</span>, </span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>                    y <span class="op">=</span><span class="st">'FactValueNumeric'</span>, </span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>                    kind<span class="op">=</span><span class="st">'scatter'</span>)</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>axs.set_xlabel(<span class="st">'GDP Per Capita'</span>)</span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>axs.set_ylabel(<span class="st">'Air pollution attributable death rate (per 100 000 population)'</span>)</span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>axs.set_title(<span class="st">'Title of this subplot'</span>)</span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> gdp_pollution[<span class="st">'GDP per capita, PPP (constant 2017 international $)'</span>].values</span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> gdp_pollution[<span class="st">'FactValueNumeric'</span>].values</span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a>f.suptitle(<span class="st">'My first graph'</span>)</span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a>f.savefig(<span class="st">'./fig1.png'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="section2_files/figure-html/cell-67-output-1.png" width="469" height="477" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>It is also possible to add the labels that indicate the country code using the annotate method.</p>
<div id="e522a4c3" class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python code-overflow-wrap code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>f, ax <span class="op">=</span> plt.subplots(figsize <span class="op">=</span> (<span class="dv">5</span>,<span class="dv">5</span>)) <span class="co"># in inches. We can define a converting factor</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>gdp_pollution.plot(ax<span class="op">=</span>ax, </span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>                    x <span class="op">=</span><span class="st">'GDP per capita, PPP (constant 2017 international $)'</span>, </span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>                    y <span class="op">=</span><span class="st">'FactValueNumeric'</span>, </span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>                    kind<span class="op">=</span><span class="st">'scatter'</span>)</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'GDP Per Capita'</span>)</span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Air pollution attributable death rate (per 100 000 population)'</span>)</span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Title of this subplot'</span>)</span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> gdp_pollution[<span class="st">'GDP per capita, PPP (constant 2017 international $)'</span>].values</span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> gdp_pollution[<span class="st">'FactValueNumeric'</span>].values</span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(gdp_pollution)): </span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a>    plt.annotate(gdp_pollution[<span class="st">'Code'</span>][i], (x[i], y[i] <span class="op">+</span> <span class="fl">0.5</span>), fontsize<span class="op">=</span><span class="dv">7</span>)</span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a>f.suptitle(<span class="st">'My first graph'</span>)</span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a>f.savefig(<span class="st">'./fig1.png'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="section2_files/figure-html/cell-68-output-1.png" width="469" height="477" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>We can also plot multiple subplots within the same figure.</p>
<div id="30251c4e" class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode python code-overflow-wrap code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>f, axs <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">1</span>, ncols<span class="op">=</span><span class="dv">2</span>, figsize <span class="op">=</span> (<span class="dv">8</span>,<span class="dv">5</span>)) <span class="co"># Now axs contains two elements</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>gdp_pollution.plot(ax<span class="op">=</span>axs[<span class="dv">0</span>], </span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>                    x <span class="op">=</span><span class="st">'GDP per capita, PPP (constant 2017 international $)'</span>, </span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>                    y <span class="op">=</span><span class="st">'FactValueNumeric'</span>,</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>                    kind<span class="op">=</span><span class="st">'scatter'</span>)</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].set_xlabel(<span class="st">'GDP Per Capita'</span>)</span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].set_ylabel(<span class="st">'Air pollution attributable death rate (per 100 000 population)'</span>)</span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].set_title(<span class="st">'Title of subplot in axs 0'</span>)</span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a>gdp_pollution.plot(ax<span class="op">=</span>axs[<span class="dv">1</span>], </span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a>                    x <span class="op">=</span><span class="st">'GDP per capita, PPP (constant 2017 international $)'</span>, </span>
<span id="cb92-14"><a href="#cb92-14" aria-hidden="true" tabindex="-1"></a>                    y <span class="op">=</span><span class="st">'FactValueNumeric'</span>, </span>
<span id="cb92-15"><a href="#cb92-15" aria-hidden="true" tabindex="-1"></a>                    kind<span class="op">=</span><span class="st">'scatter'</span>)</span>
<span id="cb92-16"><a href="#cb92-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-17"><a href="#cb92-17" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].set_xlabel(<span class="st">'GDP Per Capita'</span>)</span>
<span id="cb92-18"><a href="#cb92-18" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].set_ylabel(<span class="st">'Air pollution attributable death rate (per 100 000 population)'</span>)</span>
<span id="cb92-19"><a href="#cb92-19" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].set_title(<span class="st">'Title of subplot in axs 1'</span>)</span>
<span id="cb92-20"><a href="#cb92-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-21"><a href="#cb92-21" aria-hidden="true" tabindex="-1"></a>f.suptitle(<span class="st">'My first figure with two subplots'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="68">
<pre><code>Text(0.5, 0.98, 'My first figure with two subplots')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="section2_files/figure-html/cell-69-output-2.png" width="668" height="477" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>To perform more advanced statistical graphs, we can rely on <code>Seaborn</code>, a library that facilitates the creation of statistical graphics by leveraging <code>matplotlib</code> and integrating with pandas data structures.</p>
<div id="b7a292b0" class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>sns.set_theme(rc<span class="op">=</span>{<span class="st">'figure.figsize'</span>:(<span class="dv">4</span>,<span class="dv">4</span>)})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Functions in <code>seaborn</code> are classified as:</p>
<ul>
<li><p><strong>Figure-level</strong>: internally create their own <code>matplotlib</code> figure. When we call this type of functions, they initialize its own figure, so we cannot draw them into an existing axes. To customize its axes, we need to access the Matplotlib axes that are generated within the figure and then add or modify elements.</p></li>
<li><p><strong>Axis-levels</strong>: the return plot is a <code>matplotlib.pyplot.Axes</code> object, which means we can use them within the Matplotlib figure set up.</p></li>
</ul>
<div id="698123ce" class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode python code-overflow-wrap code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>sns.relplot(data<span class="op">=</span>gdp_pollution, </span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>            x<span class="op">=</span><span class="st">"GDP per capita, PPP (constant 2017 international $)"</span>,</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>            y<span class="op">=</span><span class="st">"FactValueNumeric"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="section2_files/figure-html/cell-71-output-1.png" width="465" height="465" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>In Seaborn we can add an additional dimension in the scatterplot by using different colors for observations in different categories specifying the “hue” parameter.</p>
<div id="91f57bee" class="cell" data-execution_count="71">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode python code-overflow-wrap code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>sns.relplot(data<span class="op">=</span>gdp_pollution, </span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>            x<span class="op">=</span><span class="st">"GDP per capita, PPP (constant 2017 international $)"</span>, </span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>            y<span class="op">=</span><span class="st">"FactValueNumeric"</span>, </span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>            hue <span class="op">=</span> <span class="st">'ParentLocation'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="section2_files/figure-html/cell-72-output-1.png" width="645" height="465" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Furthermore, it is also straightforward to use different markers for each category specifying it in the “style” option. While here we are using the same variable for the differentiation, it is also possible to specify different variables in hue and style.</p>
<div id="ebd19426" class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>sns.relplot(data<span class="op">=</span>gdp_pollution, </span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>            x<span class="op">=</span><span class="st">"GDP per capita, PPP (constant 2017 international $)"</span>,</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>            y<span class="op">=</span><span class="st">"FactValueNumeric"</span>, </span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>            hue <span class="op">=</span> <span class="st">'ParentLocation'</span>, </span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>            style<span class="op">=</span><span class="st">'ParentLocation'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="section2_files/figure-html/cell-73-output-1.png" width="645" height="465" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>To explore more options, let’s merge our data with population at the country level.</p>
<div id="1c10091f" class="cell" data-execution_count="73">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>population <span class="op">=</span> pandas.read_csv(<span class="st">'../data/population-unwpp.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="72f02d50" class="cell" data-execution_count="74">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>population <span class="op">=</span> population[(population[<span class="st">'Year'</span>]<span class="op">==</span><span class="dv">2019</span>) <span class="op">&amp;</span> (population[<span class="st">'Code'</span>].notna())]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="ac6e2814" class="cell" data-execution_count="75">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>gdp_pollution <span class="op">=</span> gdp_pollution.merge(population, </span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>                how<span class="op">=</span><span class="st">'inner'</span>, on<span class="op">=</span><span class="st">'Code'</span>, validate<span class="op">=</span><span class="st">'1:1'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, we can make each point have a different size depending on the population of the country</p>
<div id="e994433a" class="cell" data-execution_count="76">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>sns.relplot(data<span class="op">=</span>gdp_pollution, x<span class="op">=</span><span class="st">"GDP per capita, PPP (constant 2017 international $)"</span>, </span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>            y<span class="op">=</span><span class="st">"FactValueNumeric"</span>, </span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>            hue <span class="op">=</span> <span class="st">'ParentLocation'</span>, </span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>            size<span class="op">=</span><span class="st">'Population (historical estimates)'</span>, </span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>            sizes <span class="op">=</span> (<span class="dv">15</span>,<span class="dv">250</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="section2_files/figure-html/cell-77-output-1.png" width="695" height="465" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="93b5e7a9" class="cell" data-execution_count="77">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>population.sort_values(<span class="st">'Population (historical estimates)'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="77">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Entity</th>
<th data-quarto-table-cell-role="th">Code</th>
<th data-quarto-table-cell-role="th">Year</th>
<th data-quarto-table-cell-role="th">Population (historical estimates)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">16674</td>
<td>Tokelau</td>
<td>TKL</td>
<td>2019</td>
<td>1775</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">12058</td>
<td>Niue</td>
<td>NIU</td>
<td>2019</td>
<td>1943</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5562</td>
<td>Falkland Islands</td>
<td>FLK</td>
<td>2019</td>
<td>3729</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11106</td>
<td>Montserrat</td>
<td>MSR</td>
<td>2019</td>
<td>4528</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14002</td>
<td>Saint Helena</td>
<td>SHN</td>
<td>2019</td>
<td>5470</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7722</td>
<td>Indonesia</td>
<td>IDN</td>
<td>2019</td>
<td>269582880</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17580</td>
<td>United States</td>
<td>USA</td>
<td>2019</td>
<td>334319680</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7650</td>
<td>India</td>
<td>IND</td>
<td>2019</td>
<td>1383112064</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3383</td>
<td>China</td>
<td>CHN</td>
<td>2019</td>
<td>1421864064</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18354</td>
<td>World</td>
<td>OWID_WRL</td>
<td>2019</td>
<td>7764951040</td>
</tr>
</tbody>
</table>

<p>237 rows × 4 columns</p>
</div>
</div>
</div>
</div>
<p>Seaborn also has a functionality that allows to draw scatterplots with regression lines (<code>regplot</code>). The function <code>lmplot</code> allows also to draw the regression lines conditioning on other variables (i.e., by category)</p>
<div id="14229d09" class="cell" data-execution_count="78">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>sns.regplot(data<span class="op">=</span>gdp_pollution, </span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>            x<span class="op">=</span><span class="st">"GDP per capita, PPP (constant 2017 international $)"</span>,</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>            y<span class="op">=</span><span class="st">"FactValueNumeric"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="section2_files/figure-html/cell-79-output-1.png" width="374" height="363" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="99bb2570" class="cell" data-execution_count="79">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>sns.lmplot(data<span class="op">=</span>gdp_pollution,</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>         x<span class="op">=</span><span class="st">"GDP per capita, PPP (constant 2017 international $)"</span>,</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>         y<span class="op">=</span><span class="st">"FactValueNumeric"</span>,</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>         hue<span class="op">=</span><span class="st">"ParentLocation"</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="section2_files/figure-html/cell-80-output-1.png" width="641" height="464" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Specifying “col” or “row” will draw separate graphs for each category.</p>
<div id="e920dfa8" class="cell" data-execution_count="80">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>sns.lmplot(data<span class="op">=</span>gdp_pollution, </span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>            x<span class="op">=</span><span class="st">"GDP per capita, PPP (constant 2017 international $)"</span>,          </span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>            y<span class="op">=</span><span class="st">"FactValueNumeric"</span>, </span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>            hue<span class="op">=</span><span class="st">"ParentLocation"</span>, </span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>            col <span class="op">=</span><span class="st">"ParentLocation"</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="section2_files/figure-html/cell-81-output-1.png" width="2864" height="463" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p><code>lmplot</code> also performs polynomial regressions.</p>
<div id="27161e43" class="cell" data-execution_count="81">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>sns.lmplot(data<span class="op">=</span>gdp_pollution, </span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>            x<span class="op">=</span><span class="st">"GDP per capita, PPP (constant 2017 international $)"</span>, </span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>            y<span class="op">=</span><span class="st">"FactValueNumeric"</span>, </span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>            order<span class="op">=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="section2_files/figure-html/cell-82-output-1.png" width="465" height="464" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>With a similar syntaxis, we can draw histogram and density plots, which can also be helpful to understand the distribution of continuous variables.</p>
<p>For instance, in the code below we are going to draw the histogram for GDP per capita for each parent location separately.</p>
<div id="a1762976" class="cell" data-execution_count="82">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> sns.displot(data <span class="op">=</span> gdp_pollution, </span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>                x <span class="op">=</span> <span class="st">"GDP per capita, PPP (constant 2017 international $)"</span>,</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>                kind <span class="op">=</span> <span class="st">'hist'</span>,</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>                col<span class="op">=</span><span class="st">'ParentLocation'</span>)</span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>a.set_axis_labels(<span class="st">"GDP"</span>, <span class="st">"Count"</span>)</span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>a.set_titles(<span class="st">"</span><span class="sc">{col_name}</span><span class="st">"</span>)</span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>a.savefig(<span class="st">'./export.png'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="section2_files/figure-html/cell-83-output-1.png" width="2864" height="462" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Similarly, we could have used:</p>
<div id="19ab4052" class="cell" data-execution_count="83">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>f, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>sns.histplot(data <span class="op">=</span> gdp_pollution, </span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>            x <span class="op">=</span> <span class="st">"GDP per capita, PPP (constant 2017 international $)"</span>,</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>            color<span class="op">=</span><span class="st">"skyblue"</span>, </span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>            label<span class="op">=</span><span class="st">"MaxTemp"</span>, kde<span class="op">=</span><span class="va">True</span>, ax <span class="op">=</span> ax)</span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'GDP per capita'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="83">
<pre><code>Text(0.5, 0, 'GDP per capita')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="section2_files/figure-html/cell-84-output-2.png" width="366" height="361" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Heatmaps are also built-in within Seaborn and are a very popular too. to display the correlation between the variables of the dataframe. It’s like visualizing a correlation matrix with colors.</p>
<div id="17810eef" class="cell" data-execution_count="84">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>sns.heatmap(gdp_pollution[[ <span class="st">"GDP per capita, PPP (constant 2017 international $)"</span>,</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"FactValueNumeric"</span>, </span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>                         <span class="st">'Population (historical estimates)'</span>]].corr())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="section2_files/figure-html/cell-85-output-1.png" width="681" height="672" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="practice-exercises" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="practice-exercises"><span class="header-section-number">2.3</span> Practice exercises</h2>
<ol type="1">
<li><p>Write a loop that describes all columns of the credit transaction data.</p>
<div id="c5251c0d" class="cell" data-execution_count="85">
<details class="code-fold">
<summary>Show solution</summary>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> c <span class="kw">in</span> data.columns:</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div></li>
<li><p>Write a loop that plots in a different subplot the scatterplot of GDP vs mortality for each Parent Location. It should have 3 columns and 2 rows.</p>
<div id="024fd648" class="cell" data-execution_count="86">
<details class="code-fold">
<summary>Show solution</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Defining a 2x2 grid of subplots</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>fig, axs <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">2</span>,ncols<span class="op">=</span><span class="dv">3</span>,figsize<span class="op">=</span>(<span class="dv">16</span>,<span class="dv">10</span>))</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(wspace<span class="op">=</span><span class="fl">0.5</span>) <span class="co">#adjusting white space between individual plots</span></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a><span class="co"># get list of parent locations</span></span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>parentl <span class="op">=</span> gdp_pollution[<span class="st">'ParentLocation'</span>].unique()</span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a><span class="co"># create dictionary of colors for each country </span></span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Define six colors</span></span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a>palette <span class="op">=</span> sns.color_palette()</span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-11"><a href="#cb112-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the palette to assign colors to parent locations</span></span>
<span id="cb112-12"><a href="#cb112-12" aria-hidden="true" tabindex="-1"></a>colors <span class="op">=</span> palette[:<span class="bu">len</span>(parentl)]</span>
<span id="cb112-13"><a href="#cb112-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a dictionary mapping parent locations to colors</span></span>
<span id="cb112-14"><a href="#cb112-14" aria-hidden="true" tabindex="-1"></a>parent_color_dict <span class="op">=</span> <span class="bu">dict</span>(<span class="bu">zip</span>(parentl, colors))</span>
<span id="cb112-15"><a href="#cb112-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-16"><a href="#cb112-16" aria-hidden="true" tabindex="-1"></a><span class="co"># convert to an array with the shapes of the figure we want so that we can loop over them </span></span>
<span id="cb112-17"><a href="#cb112-17" aria-hidden="true" tabindex="-1"></a>parentl_arr<span class="op">=</span> np.array(parentl)</span>
<span id="cb112-18"><a href="#cb112-18" aria-hidden="true" tabindex="-1"></a>parentl_arr<span class="op">=</span> parentl_arr.reshape(<span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb112-19"><a href="#cb112-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-20"><a href="#cb112-20" aria-hidden="true" tabindex="-1"></a><span class="co"># looping over the 2x2 grid</span></span>
<span id="cb112-21"><a href="#cb112-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span>):</span>
<span id="cb112-22"><a href="#cb112-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">3</span>):</span>
<span id="cb112-23"><a href="#cb112-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-24"><a href="#cb112-24" aria-hidden="true" tabindex="-1"></a>        <span class="co">#extract the part of the data for that subset of countries</span></span>
<span id="cb112-25"><a href="#cb112-25" aria-hidden="true" tabindex="-1"></a>        aux <span class="op">=</span> gdp_pollution[gdp_pollution[<span class="st">'ParentLocation'</span>]<span class="op">==</span>parentl_arr[i,j]]</span>
<span id="cb112-26"><a href="#cb112-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-27"><a href="#cb112-27" aria-hidden="true" tabindex="-1"></a>        <span class="co">#Making the scatterplot</span></span>
<span id="cb112-28"><a href="#cb112-28" aria-hidden="true" tabindex="-1"></a>        aux.plot(ax<span class="op">=</span>axs[i,j], x <span class="op">=</span><span class="st">'GDP per capita, PPP (constant 2017 international $)'</span>, </span>
<span id="cb112-29"><a href="#cb112-29" aria-hidden="true" tabindex="-1"></a>                y <span class="op">=</span><span class="st">'FactValueNumeric'</span>, kind<span class="op">=</span><span class="st">'scatter'</span>, color<span class="op">=</span>parent_color_dict[parentl_arr[i,j]])</span>
<span id="cb112-30"><a href="#cb112-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-31"><a href="#cb112-31" aria-hidden="true" tabindex="-1"></a>        <span class="co"># label axes</span></span>
<span id="cb112-32"><a href="#cb112-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-33"><a href="#cb112-33" aria-hidden="true" tabindex="-1"></a>        axs[i,j].set_xlabel(<span class="st">'GDP per capita'</span>)</span>
<span id="cb112-34"><a href="#cb112-34" aria-hidden="true" tabindex="-1"></a>        axs[i,j].set_ylabel(<span class="st">'Pollution induced mortality'</span>)</span>
<span id="cb112-35"><a href="#cb112-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-36"><a href="#cb112-36" aria-hidden="true" tabindex="-1"></a>        <span class="co"># set title of subplot</span></span>
<span id="cb112-37"><a href="#cb112-37" aria-hidden="true" tabindex="-1"></a>        axs[i,j].set_title(parentl_arr[i,j])</span>
<span id="cb112-38"><a href="#cb112-38" aria-hidden="true" tabindex="-1"></a>        <span class="co">#Putting a dollar sign, and thousand-comma separator on x-axis labels</span></span>
<span id="cb112-39"><a href="#cb112-39" aria-hidden="true" tabindex="-1"></a>        axs[i,j].xaxis.set_major_formatter(<span class="st">'$</span><span class="sc">{x:,.0f}</span><span class="st">'</span>)</span>
<span id="cb112-40"><a href="#cb112-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-41"><a href="#cb112-41" aria-hidden="true" tabindex="-1"></a>        <span class="co"># increasing font size of axis labels</span></span>
<span id="cb112-42"><a href="#cb112-42" aria-hidden="true" tabindex="-1"></a>        axs[i,j].tick_params(axis <span class="op">=</span> <span class="st">'both'</span>,labelsize<span class="op">=</span><span class="dv">6</span>)</span>
<span id="cb112-43"><a href="#cb112-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-44"><a href="#cb112-44" aria-hidden="true" tabindex="-1"></a>parentl_arr[i,j]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div></li>
</ol>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../s1_intro_python.html" class="pagination-link" aria-label="Course foundations:
Jupyter Notebooks, Python syntax, and NumPy">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Course foundations: Jupyter Notebooks, Python syntax, and NumPy</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../notebooks_md/section3.html" class="pagination-link" aria-label="Introducing geographic data">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Introducing geographic data</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>